<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>30秒お絵描きチャレンジ</title>
<style>
:root{
  --accent:#f95d5d;
  --bg:#fafafa;
}
body{
  margin:0;
  background:var(--bg);
  font-family: system-ui, sans-serif;
  text-align:center;
}
header{
  background:var(--accent);
  color:#fff;
  padding:16px;
  font-weight:700;
  font-size:1.2rem;
}
#timer{
  margin:12px 0;
  font-size:1.5rem;
  color:#333;
}
#drawArea{
  border:2px solid #ccc;
  border-radius:8px;
  background:#fff;
  touch-action:none; /* タッチ描画用 */
}
.buttons{
  margin:16px 0;
  display:flex;
  justify-content:center;
  gap:16px;
}
button{
  padding:10px 18px;
  border:none;
  border-radius:8px;
  font-weight:700;
  background:#333;
  color:#fff;
  cursor:pointer;
}
button:disabled{
  opacity:0.5;
  cursor:not-allowed;
}
</style>
</head>
<body>

<!-- ★ ここがお題：この文字を好きに変えるだけでOK -->
<header id="topic"></header>

<div id="timer">残り30秒</div>
<canvas id="drawArea" width="360" height="480"></canvas>

<div class="buttons">
  <button id="clearBtn">やり直し</button>
  <button id="saveBtn" disabled>保存</button>
</div>

<script>
//======================
// ★ お題変更はここ！
//======================
const TOPIC = "食パンマンが飛んでいる様子"; // ←この文字列を変えるだけ

document.getElementById('topic').textContent = `お題：${TOPIC}`;

// タイマー設定
let timeLeft = 30; // 秒
const timerEl = document.getElementById('timer');
const countdown = setInterval(()=>{
  timeLeft--;
  timerEl.textContent = `残り${timeLeft}秒`;
  if(timeLeft <= 0){
    clearInterval(countdown);
    endDrawing();
  }
},1000);

// 描画関連
const canvas = document.getElementById('drawArea');
const ctx = canvas.getContext('2d');
ctx.lineWidth = 4;
ctx.lineCap = 'round';
ctx.lineJoin = 'round';
ctx.strokeStyle = '#000';

let drawing = false;

function startDraw(e){
  drawing = true;
  ctx.beginPath();
  ctx.moveTo(getX(e), getY(e));
}
function draw(e){
  if(!drawing) return;
  ctx.lineTo(getX(e), getY(e));
  ctx.stroke();
}
function endDraw(){
  drawing = false;
}
function getX(e){return (e.touches? e.touches[0].clientX : e.clientX) - canvas.getBoundingClientRect().left;}
function getY(e){return (e.touches? e.touches[0].clientY : e.clientY) - canvas.getBoundingClientRect().top;}

canvas.addEventListener('mousedown', startDraw);
canvas.addEventListener('mousemove', draw);
canvas.addEventListener('mouseup', endDraw);
canvas.addEventListener('mouseleave', endDraw);

canvas.addEventListener('touchstart', e=>{e.preventDefault();startDraw(e);});
canvas.addEventListener('touchmove', e=>{e.preventDefault();draw(e);});
canvas.addEventListener('touchend', e=>{e.preventDefault();endDraw();});

// 30秒経過後
function endDrawing(){
  canvas.removeEventListener('mousedown', startDraw);
  canvas.removeEventListener('mousemove', draw);
  canvas.removeEventListener('touchstart', startDraw);
  canvas.removeEventListener('touchmove', draw);
  document.getElementById('saveBtn').disabled = false;
  timerEl.textContent = "時間終了！保存できます";
}

// クリア
document.getElementById('clearBtn').addEventListener('click',()=>{
  ctx.clearRect(0,0,canvas.width,canvas.height);
});

// 保存
document.getElementById('saveBtn').addEventListener('click',()=>{
  const link = document.createElement('a');
  link.download = 'drawing.png';
  link.href = canvas.toDataURL('image/png');
  link.click();
});
</script>
</body>
</html>
